#!/usr/bin/env python3

import sys
import os

args = sys.argv[1:]
interactive = True

if len(args) > 0 and args[0] == '--noninteractive':
  interactive = False
  args.pop(0)

if len(args) < 2:
  print('Usage: run-php PHPVERSION')
  exit(1)

version = args.pop(0)

cmdArgs = [
        'run',
        '--tty' if interactive else None,
        '--interactive' if interactive else None,
        '--rm',
        '-v',
        os.getcwd()+':/app',
        '--workdir=/app',
        'thedxw/php-testing:'+version,
        ]

# Filter out any Nones
cmdArgs = [arg for arg in cmdArgs if arg!=None]

os.execvp('docker', ['docker'] + cmdArgs + args)
